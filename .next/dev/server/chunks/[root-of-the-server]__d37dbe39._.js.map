{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 112, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/my-first-next-js/src/app/api/auth/%5B...nextauth%5D/route.js"],"sourcesContent":["import NextAuth from \"next-auth\";\r\nimport GoogleProvider from \"next-auth/providers/google\";\r\nimport CredentialsProvider from \"next-auth/providers/credentials\";\r\nimport { MongoClient } from \"mongodb\";\r\nimport bcrypt from \"bcryptjs\";\r\n\r\nconst uri = process.env.MONGO_URI;\r\nconst client = new MongoClient(uri);\r\n\r\nasync function getUser(email) {\r\n  await client.connect();\r\n  const db = client.db(\"next_auth\");\r\n  return db.collection(\"users\").findOne({ email });\r\n}\r\n\r\nconst handler = NextAuth({\r\n  providers: [\r\n    GoogleProvider({\r\n      clientId: process.env.GOOGLE_CLIENT_ID,\r\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET,\r\n    }),\r\n\r\n    CredentialsProvider({\r\n      name: \"Credentials\",\r\n      credentials: {\r\n        email: { label: \"Email\", type: \"text\" },\r\n        password: { label: \"Password\", type: \"password\" },\r\n      },\r\n\r\n      async authorize(credentials) {\r\n        const user = await getUser(credentials.email);\r\n\r\n        if (!user) {\r\n          throw new Error(\"User not found\");\r\n        }\r\n\r\n        const isCorrect = await bcrypt.compare(\r\n          credentials.password,\r\n          user.password\r\n        );\r\n\r\n        if (!isCorrect) {\r\n          throw new Error(\"Invalid password\");\r\n        }\r\n\r\n        return {\r\n          id: user._id,\r\n          name: user.name,\r\n          email: user.email,\r\n        };\r\n      },\r\n    }),\r\n  ],\r\n\r\n  pages: {\r\n    signIn: \"/login\",\r\n  },\r\n\r\n  session: {\r\n    strategy: \"jwt\",\r\n  },\r\n\r\n  secret: process.env.NEXTAUTH_SECRET,\r\n});\r\n\r\nexport { handler as GET, handler as POST };\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;AACA;AACA;;;;;;AAEA,MAAM,MAAM,QAAQ,GAAG,CAAC,SAAS;AACjC,MAAM,SAAS,IAAI,sHAAW,CAAC;AAE/B,eAAe,QAAQ,KAAK;IAC1B,MAAM,OAAO,OAAO;IACpB,MAAM,KAAK,OAAO,EAAE,CAAC;IACrB,OAAO,GAAG,UAAU,CAAC,SAAS,OAAO,CAAC;QAAE;IAAM;AAChD;AAEA,MAAM,UAAU,IAAA,kJAAQ,EAAC;IACvB,WAAW;QACT,IAAA,gKAAc,EAAC;YACb,UAAU,QAAQ,GAAG,CAAC,gBAAgB;YACtC,cAAc,QAAQ,GAAG,CAAC,oBAAoB;QAChD;QAEA,IAAA,qKAAmB,EAAC;YAClB,MAAM;YACN,aAAa;gBACX,OAAO;oBAAE,OAAO;oBAAS,MAAM;gBAAO;gBACtC,UAAU;oBAAE,OAAO;oBAAY,MAAM;gBAAW;YAClD;YAEA,MAAM,WAAU,WAAW;gBACzB,MAAM,OAAO,MAAM,QAAQ,YAAY,KAAK;gBAE5C,IAAI,CAAC,MAAM;oBACT,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,YAAY,MAAM,8IAAM,CAAC,OAAO,CACpC,YAAY,QAAQ,EACpB,KAAK,QAAQ;gBAGf,IAAI,CAAC,WAAW;oBACd,MAAM,IAAI,MAAM;gBAClB;gBAEA,OAAO;oBACL,IAAI,KAAK,GAAG;oBACZ,MAAM,KAAK,IAAI;oBACf,OAAO,KAAK,KAAK;gBACnB;YACF;QACF;KACD;IAED,OAAO;QACL,QAAQ;IACV;IAEA,SAAS;QACP,UAAU;IACZ;IAEA,QAAQ,QAAQ,GAAG,CAAC,eAAe;AACrC"}}]
}